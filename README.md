[{"id":"8886b422.0bd738","type":"mqtt in","z":"bca64c3b.0e4c","name":"","topic":"/home/general/Memory/float/Temperature_Zone_N_[K]","qos":"2","broker":"66e6ce19.241c6","x":280,"y":100,"wires":[["ecd99634.e97ca8"]]},{"id":"953fe853.1767c8","type":"mqtt out","z":"bca64c3b.0e4c","name":"mqtt thingspeak out","topic":"","qos":"","retain":"","broker":"7153c242.194b6c","x":1159,"y":227,"wires":[]},{"id":"ecd99634.e97ca8","type":"function","z":"bca64c3b.0e4c","name":"translate home io payload to thingspeak","func":"var API_KEY = \"8HX6895TV90H9EIB\";\n\nvar topicSplit = msg.topic.split(/[/]+/);\n\n// Flag continuous messages\nmsg.shouldBeThrottled = false;\nif(\n topicSplit[3] == \"Memory\" ||\n topicSplit[5].startsWith(\"Thermostat\") ||\n topicSplit[5].startsWith(\"Date_and_Time\") ||\n topicSplit[5].startsWith(\"Brightness\")){\n msg.shouldBeThrottled = true;\n}\n\n// Build ThingSpeak payload\nvar value = msg.payload;\nif(topicSplit[3] == \"bool\"){\n value = msg.payload==\"True\"?1:0;\n}\nmsg.payload = Date.now() + \",\" + topicSplit[topicSplit.length - 1] + \",\" + value + \",\" + API_KEY;\nmsg.topic = \"devices\" + msg.topic;\n\n// Don't proceed if the API key isn't set properly\nif(API_KEY != \"8HX6895TV90H9EIB\") return null;\n\nreturn msg;","outputs":1,"noerr":0,"x":660,"y":100,"wires":[["6b164c9d.d68674"]]},{"id":"e6aa98c4.9860a8","type":"delay","z":"bca64c3b.0e4c","name":"limit continunous update rate","pauseType":"timed","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"5","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":799,"y":167,"wires":[["953fe853.1767c8"]]},{"id":"6b164c9d.d68674","type":"switch","z":"bca64c3b.0e4c","name":"filter continuous update data","property":"shouldBeThrottled","propertyType":"msg","rules":[{"t":"eq","v":"true","vt":"jsonata"},{"t":"eq","v":"false","vt":"jsonata"}],"checkall":"true","repair":false,"outputs":2,"x":380,"y":220,"wires":[["e6aa98c4.9860a8"],["953fe853.1767c8"]]},{"id":"1b30d24f.802d3e","type":"mqtt in","z":"bca64c3b.0e4c","name":"","topic":"/home/O/Input/float/Brightness_Sensor_(Analog)","qos":"2","broker":"66e6ce19.241c6","x":269,"y":1127,"wires":[["8a31c3fe.61748"]]},{"id":"b97b9e0d.e9a0c","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/O/Output/float/Lights_Pool_(Analog)","qos":"","retain":"","broker":"a2c91eda.08e26","x":1319,"y":1067,"wires":[]},{"id":"991d953c.6bfb98","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/O/Output/float/Lights_Porch_1_(Analog)","qos":"","retain":"","broker":"a2c91eda.08e26","x":1329,"y":1147,"wires":[]},{"id":"50874117.1c25","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/O/Output/float/Lights_Porch_2_(Analog)","qos":"","retain":"","broker":"a2c91eda.08e26","x":1329,"y":1107,"wires":[]},{"id":"d6243fa5.96dd3","type":"function","z":"bca64c3b.0e4c","name":"LightControl","func":"if(msg.brightness !== undefined){\n    if(msg.brightness < 1.8){\n        msg.payload = 8;\n    }else{\n        msg.payload = 0;\n    }\n    return msg;\n}\nif(msg.hour !== undefined){\n    msg.payload = 3;\n    return msg;\n}","outputs":1,"noerr":0,"x":959,"y":1187,"wires":[["b97b9e0d.e9a0c","50874117.1c25","991d953c.6bfb98","e23ed32.03b6f3"]]},{"id":"e23ed32.03b6f3","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/O/Output/float/Lights_Garden_(Analog)","qos":"","retain":"","broker":"a2c91eda.08e26","x":1329,"y":1187,"wires":[]},{"id":"8a31c3fe.61748","type":"delay","z":"bca64c3b.0e4c","name":"limit","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"21","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":479,"y":1127,"wires":[["420262e.e2cf39c"]]},{"id":"c2a7fc0e.b2c67","type":"comment","z":"bca64c3b.0e4c","name":"OUT Door Light Controller Demo","info":"","x":139,"y":1047,"wires":[]},{"id":"4b7a6565.e46ecc","type":"mqtt in","z":"bca64c3b.0e4c","name":"","topic":"/home/+/Input/bool/Motion_Detector","qos":"2","broker":"a2c91eda.08e26","x":229,"y":387,"wires":[["b2f0dc7c.37ec"]]},{"id":"e736fa87.8959e8","type":"function","z":"bca64c3b.0e4c","name":"chooseRoom","func":"var API_KEY = \"8HX6895TV90H9EIB\";\n\nvar split = msg.topic.split(/[/]+/);\n\nmsg.room = split[2];\n\na = \"True\";\nif(msg.payload == a){\n    msg.open = true;\n}else{\n    msg.open = false;\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":279,"y":507,"wires":[["674e7044.a7374"]]},{"id":"38ee17fa.ce22a8","type":"delay","z":"bca64c3b.0e4c","name":"","pauseType":"delay","timeout":"10","timeoutUnits":"seconds","rate":"1","nbRateUnits":"20","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":289,"y":607,"wires":[["597ac6e7.798f58"]]},{"id":"674e7044.a7374","type":"switch","z":"bca64c3b.0e4c","name":"seperate signal","property":"open","propertyType":"msg","rules":[{"t":"eq","v":"true","vt":"jsonata"},{"t":"eq","v":"false","vt":"jsonata"}],"checkall":"true","repair":false,"outputs":2,"x":269,"y":547,"wires":[["597ac6e7.798f58"],["38ee17fa.ce22a8"]]},{"id":"597ac6e7.798f58","type":"switch","z":"bca64c3b.0e4c","name":"Rooms","property":"room","propertyType":"msg","rules":[{"t":"eq","v":"A","vt":"str"},{"t":"eq","v":"B","vt":"str"},{"t":"eq","v":"C","vt":"str"},{"t":"eq","v":"D","vt":"str"},{"t":"eq","v":"E","vt":"str"},{"t":"eq","v":"F","vt":"str"},{"t":"eq","v":"G","vt":"str"},{"t":"eq","v":"H","vt":"str"},{"t":"eq","v":"I","vt":"str"},{"t":"eq","v":"J","vt":"str"},{"t":"eq","v":"K","vt":"str"},{"t":"eq","v":"L","vt":"str"},{"t":"eq","v":"M","vt":"str"},{"t":"eq","v":"N","vt":"str"},{"t":"eq","v":"O","vt":"str"}],"checkall":"true","repair":false,"outputs":15,"x":500,"y":560,"wires":[["4b985b7e.501764"],["ca5edb16.813e48"],["230b9546.4cd0aa"],["bd9f1df9.a0b99"],["8e27175d.ffbcf8"],["33519017.0b2a1"],["577afc74.bb7474"],["d614740d.6f02c8"],["e02e58f0.b3aac8"],["48a4d655.d8b4c8"],["845a0dc9.06e79"],["7e8aad73.f29604"],["55d19351.92a6fc"],["f46c36c4.a6ab78"],["30414441.9939ac"]]},{"id":"4b985b7e.501764","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/A/Output/bool/Lights","qos":"","retain":"","broker":"a2c91eda.08e26","x":800,"y":340,"wires":[]},{"id":"230b9546.4cd0aa","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/C/Output/bool/Lights","qos":"","retain":"","broker":"a2c91eda.08e26","x":800,"y":420,"wires":[]},{"id":"8e27175d.ffbcf8","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/E/Output/bool/Lights","qos":"","retain":"","broker":"a2c91eda.08e26","x":800,"y":500,"wires":[]},{"id":"577afc74.bb7474","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/G/Output/bool/Lights","qos":"","retain":"","broker":"a2c91eda.08e26","x":800,"y":580,"wires":[]},{"id":"d614740d.6f02c8","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/H/Output/bool/Lights","qos":"","retain":"","broker":"a2c91eda.08e26","x":800,"y":620,"wires":[]},{"id":"48a4d655.d8b4c8","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/J/Output/bool/Lights","qos":"","retain":"","broker":"a2c91eda.08e26","x":800,"y":700,"wires":[]},{"id":"845a0dc9.06e79","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/K/Output/bool/Lights","qos":"","retain":"","broker":"a2c91eda.08e26","x":800,"y":740,"wires":[]},{"id":"7e8aad73.f29604","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/L/Output/bool/Lights","qos":"","retain":"","broker":"a2c91eda.08e26","x":800,"y":780,"wires":[]},{"id":"55d19351.92a6fc","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/M/Output/bool/Lights","qos":"","retain":"","broker":"a2c91eda.08e26","x":800,"y":820,"wires":[]},{"id":"30414441.9939ac","type":"mqtt out","z":"bca64c3b.0e4c","name":"Lights_Entrance","topic":"/home/O/Output/bool/Lights_Entrance","qos":"","retain":"","broker":"a2c91eda.08e26","x":770,"y":940,"wires":[]},{"id":"ca5edb16.813e48","type":"function","z":"bca64c3b.0e4c","name":"Room B-2 Lights 1&2","func":"\nreturn msg;","outputs":1,"noerr":0,"x":780,"y":380,"wires":[["e6b93d65.c1499","efadabad.7487e8"]]},{"id":"e6b93d65.c1499","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/B/Output/bool/Lights_1","qos":"","retain":"","broker":"a2c91eda.08e26","x":1140,"y":360,"wires":[]},{"id":"efadabad.7487e8","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/B/Output/bool/Lights_2","qos":"","retain":"","broker":"a2c91eda.08e26","x":1140,"y":400,"wires":[]},{"id":"bd9f1df9.a0b99","type":"function","z":"bca64c3b.0e4c","name":"Room D-2 Lights 1&2","func":"\nreturn msg;","outputs":1,"noerr":0,"x":780,"y":460,"wires":[["7c0f8e4f.f8ef4","79bb58.f0b064a8"]]},{"id":"33519017.0b2a1","type":"function","z":"bca64c3b.0e4c","name":"Room F-2 Lights 1&2","func":"\nreturn msg;","outputs":1,"noerr":0,"x":780,"y":540,"wires":[["825825e0.9b2c58","238534f9.499cec"]]},{"id":"e02e58f0.b3aac8","type":"function","z":"bca64c3b.0e4c","name":"Room I-2 Lights 1&2","func":"\nreturn msg;","outputs":1,"noerr":0,"x":780,"y":660,"wires":[["1ccad752.055b39","12150512.11a70b"]]},{"id":"f46c36c4.a6ab78","type":"function","z":"bca64c3b.0e4c","name":"Room N-2 Lights 1&2&3","func":"\nreturn msg;","outputs":1,"noerr":0,"x":790,"y":880,"wires":[["1c5f3b43.a490d5","feeb1aaf.171cf8","6ed0f8da.9bb918"]]},{"id":"79bb58.f0b064a8","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/D/Output/bool/Lights_2","qos":"","retain":"","broker":"a2c91eda.08e26","x":1140,"y":480,"wires":[]},{"id":"7c0f8e4f.f8ef4","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/D/Output/bool/Lights_1","qos":"","retain":"","broker":"a2c91eda.08e26","x":1140,"y":440,"wires":[]},{"id":"238534f9.499cec","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/F/Output/bool/Lights_2","qos":"","retain":"","broker":"a2c91eda.08e26","x":1140,"y":560,"wires":[]},{"id":"825825e0.9b2c58","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/F/Output/bool/Lights_1","qos":"","retain":"","broker":"a2c91eda.08e26","x":1140,"y":520,"wires":[]},{"id":"1ccad752.055b39","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/I/Output/bool/Lights_1","qos":"","retain":"","broker":"a2c91eda.08e26","x":1140,"y":627,"wires":[]},{"id":"12150512.11a70b","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/I/Output/bool/Lights_2","qos":"","retain":"","broker":"a2c91eda.08e26","x":1140,"y":687,"wires":[]},{"id":"1c5f3b43.a490d5","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/N/Output/bool/Lights_1","qos":"","retain":"","broker":"a2c91eda.08e26","x":1140,"y":840,"wires":[]},{"id":"feeb1aaf.171cf8","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/N/Output/bool/Lights_2","qos":"","retain":"","broker":"a2c91eda.08e26","x":1140,"y":880,"wires":[]},{"id":"6ed0f8da.9bb918","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/N/Output/bool/Lights_3","qos":"","retain":"","broker":"a2c91eda.08e26","x":1140,"y":920,"wires":[]},{"id":"17bdcbea.e7aa84","type":"comment","z":"bca64c3b.0e4c","name":"IN Door Light Controller Demo","info":"","x":129,"y":347,"wires":[]},{"id":"43e9c6e5.ecce98","type":"mqtt in","z":"bca64c3b.0e4c","name":"Brightness_Capteur","topic":"/home/O/Input/float/Brightness_Sensor_(Analog)","qos":"2","broker":"66e6ce19.241c6","x":219,"y":1567,"wires":[["a802ad.1d8b8d5"]]},{"id":"4f6e306c.6c226","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/A/Output/bool/Roller_Shades_1_(Up)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1619,"y":1227,"wires":[]},{"id":"a802ad.1d8b8d5","type":"delay","z":"bca64c3b.0e4c","name":"limit","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"10","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":259,"y":1627,"wires":[["d9197eb0.85a2c"]]},{"id":"2dcdc346.3f9dfc","type":"function","z":"bca64c3b.0e4c","name":"Open","func":"msg.payload = true;\nreturn msg;","outputs":1,"noerr":0,"x":639,"y":1687,"wires":[["a7bc68ec.df0f18","60fd8a6c.f4fce4"]]},{"id":"b057f74b.d60808","type":"function","z":"bca64c3b.0e4c","name":"Close","func":"\nreturn msg;","outputs":1,"noerr":0,"x":639,"y":1567,"wires":[["e2f39a17.531ba8","da1b741f.e5e998"]]},{"id":"60fd8a6c.f4fce4","type":"change","z":"bca64c3b.0e4c","name":"reverse","rules":[{"t":"set","p":"payload","pt":"msg","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":779,"y":1707,"wires":[["ffb968c6.3a7528"]]},{"id":"a7bc68ec.df0f18","type":"trigger","z":"bca64c3b.0e4c","op1":"true","op2":"false","op1type":"bool","op2type":"bool","duration":"1","extend":false,"units":"s","reset":"","bytopic":"topic","name":"ActionTime","x":789,"y":1667,"wires":[["fb5178df.c07218"]]},{"id":"da1b741f.e5e998","type":"change","z":"bca64c3b.0e4c","name":"reverse","rules":[{"t":"set","p":"payload","pt":"msg","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":779,"y":1547,"wires":[["fb5178df.c07218"]]},{"id":"e2f39a17.531ba8","type":"trigger","z":"bca64c3b.0e4c","op1":"true","op2":"false","op1type":"bool","op2type":"bool","duration":"1","extend":false,"units":"s","reset":"","bytopic":"topic","name":"ActionTime","x":799,"y":1587,"wires":[["ffb968c6.3a7528"]]},{"id":"c345706b.1ad3a","type":"mqtt in","z":"bca64c3b.0e4c","name":"Openness_Capteur","topic":"/home/J/Input/float/Roller_Shades_(Openness)","qos":"2","broker":"e6cc5916.4480c8","x":1590,"y":280,"wires":[["977337a0.fe68c8"]]},{"id":"977337a0.fe68c8","type":"delay","z":"bca64c3b.0e4c","name":"limit","pauseType":"queue","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1790,"y":280,"wires":[["2bd148e8.f7d678"]]},{"id":"2bd148e8.f7d678","type":"function","z":"bca64c3b.0e4c","name":"getOpenness","func":"if(context.global.OpennessGLOBAL === undefined){\n    context.global.set(\"OpennessGLOBAL\");\n}\ncontext.global.OpennessGLOBAL = msg.payload;\nmsg.a = msg.payload;","outputs":0,"noerr":0,"x":1960,"y":280,"wires":[]},{"id":"d9197eb0.85a2c","type":"function","z":"bca64c3b.0e4c","name":"modeChoose","func":"if(msg.payload < 4){\n    msg.payload = true;\n}else{\n    msg.payload = false;\n}\nmsg.s = global.get(\"OpennessGLOBAL\");\nif(msg.payload){\n    if(global.get(\"OpennessGLOBAL\") > 0){\n        return msg;\n    }\n}else{\n    if(global.get(\"OpennessGLOBAL\") < 10){\n        return msg;\n    }\n}\n","outputs":1,"noerr":0,"x":219,"y":1687,"wires":[["9ad9201a.15832"]]},{"id":"62b1684a.479258","type":"switch","z":"bca64c3b.0e4c","name":"choseMode","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"true","vt":"jsonata"},{"t":"eq","v":"false","vt":"jsonata"}],"checkall":"true","repair":false,"outputs":2,"x":459,"y":1627,"wires":[["b057f74b.d60808"],["2dcdc346.3f9dfc"]]},{"id":"fb5178df.c07218","type":"function","z":"bca64c3b.0e4c","name":"UP","func":"\nreturn msg;","outputs":1,"noerr":0,"x":979,"y":1547,"wires":[["4f6e306c.6c226","27b0e718.852568","780b0c49.6c2004","c61ce339.b5e02","f906698.bc63498","e75e8aa1.bdfb98","15e8cc7c.6b5344","a5650383.634c6","c2e9fe96.991b5","a916fb6e.0ac3e8","9a67c72.534ce38","2db6bca2.59a074","6775ea7d.3c94c4"]]},{"id":"ffb968c6.3a7528","type":"function","z":"bca64c3b.0e4c","name":"DOWN","func":"\nreturn msg;","outputs":1,"noerr":0,"x":989,"y":1707,"wires":[["2db1ec9.e14ec14","831d7be9.fe1ba8","42ce3437.ce0f9c","e65fb6f4.a84758","59761d80.70add4","edf8af01.ac7fc","eca1f25c.3b4d4","507e3c44.c872a4","187c102f.073f1","7eb4bc13.f20294","7694c44.146f53c","8ac6a6a4.0b2d28","94e09e23.08506"]]},{"id":"27b0e718.852568","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/A/Output/bool/Roller_Shades_2_(Up)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1619,"y":1267,"wires":[]},{"id":"780b0c49.6c2004","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/A/Output/bool/Roller_Shades_3_(Up)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1619,"y":1307,"wires":[]},{"id":"2db1ec9.e14ec14","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/A/Output/bool/Roller_Shades_1_(Down)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1629,"y":1767,"wires":[]},{"id":"831d7be9.fe1ba8","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/A/Output/bool/Roller_Shades_2_(Down)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1629,"y":1807,"wires":[]},{"id":"42ce3437.ce0f9c","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/A/Output/bool/Roller_Shades_3_(Down)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1629,"y":1847,"wires":[]},{"id":"c61ce339.b5e02","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/A/Output/bool/Roller_Shades_4_(Up)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1619,"y":1347,"wires":[]},{"id":"e65fb6f4.a84758","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/A/Output/bool/Roller_Shades_4_(Down)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1629,"y":1887,"wires":[]},{"id":"da35981b.bee988","type":"comment","z":"bca64c3b.0e4c","name":"Volet automatique Demo","info":"","x":109,"y":1507,"wires":[]},{"id":"de1331af.19df7","type":"comment","z":"bca64c3b.0e4c","name":"Remote light","info":"","x":59,"y":2527,"wires":[]},{"id":"346ac213.382b0e","type":"comment","z":"bca64c3b.0e4c","name":"Openness detect Global","info":"","x":1490,"y":220,"wires":[]},{"id":"690e863e.7c4788","type":"link in","z":"bca64c3b.0e4c","name":"","links":["7afd1fbc.0beb"],"x":444,"y":1187,"wires":[["d7baa44f.d15938"]]},{"id":"de154b48.e4f118","type":"mqtt in","z":"bca64c3b.0e4c","name":"TimeLocal","topic":"/home/general/Memory/DateTime/Date_and_Time","qos":"2","broker":"e6cc5916.4480c8","x":1550,"y":120,"wires":[["5b599703.728638"]]},{"id":"5b599703.728638","type":"delay","z":"bca64c3b.0e4c","name":"limit","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"26","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1690,"y":120,"wires":[["4a97e153.ba593"]]},{"id":"4a97e153.ba593","type":"function","z":"bca64c3b.0e4c","name":"ToTime","func":"var time = msg.payload.split(\" \");\nvar timeSplit = time[1];\nvar s = timeSplit.split(\":\");\nmsg.hour = s[0];\nmsg.minute = s[1];\nmsg.second = s[2];\nreturn msg;","outputs":1,"noerr":0,"x":1840,"y":120,"wires":[["641feadd.92cb54"]]},{"id":"641feadd.92cb54","type":"function","z":"bca64c3b.0e4c","name":"timeTransfer","func":"\n\ncontext.global.time = 3600*msg.hour + 60*msg.minute + msg.second;\ncontext.global.hour = msg.hour;\ncontext.global.minute = msg.minute;\ncontext.global.second = msg.second;\nreturn msg;","outputs":1,"noerr":0,"x":2020,"y":120,"wires":[["7afd1fbc.0beb"]]},{"id":"59ce6b82.093514","type":"comment","z":"bca64c3b.0e4c","name":"Local_TIME","info":"","x":1430,"y":60,"wires":[]},{"id":"7afd1fbc.0beb","type":"link out","z":"bca64c3b.0e4c","name":"TIME","links":["690e863e.7c4788"],"x":2135,"y":120,"wires":[]},{"id":"58e844a2.262cbc","type":"mosca in","z":"bca64c3b.0e4c","mqtt_port":1883,"mqtt_ws_port":8080,"name":"","username":"","password":"","dburl":"","x":109,"y":47,"wires":[[]]},{"id":"d7baa44f.d15938","type":"function","z":"bca64c3b.0e4c","name":"TimeSignalBlocker","func":"if(context.global.hour >22 || context.global.hour<7){\n    msg.hour = context.global.hour;\n    return msg;\n}\n","outputs":1,"noerr":0,"x":619,"y":1187,"wires":[["65806d8b.cb1944"]]},{"id":"420262e.e2cf39c","type":"function","z":"bca64c3b.0e4c","name":"setBrightness","func":"msg.brightness = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"x":609,"y":1127,"wires":[["65806d8b.cb1944"]]},{"id":"806ca5b1.64ce88","type":"ui_dropdown","z":"bca64c3b.0e4c","name":"Room","label":"","place":"","group":"55c8875e.fd1cd8","order":0,"width":"3","height":"1","passthru":true,"options":[{"label":"A","value":"A","type":"str"},{"label":"B","value":"B","type":"str"},{"label":"C","value":"C","type":"str"},{"label":"D","value":"D","type":"str"},{"label":"E","value":"E","type":"str"},{"label":"F","value":"F","type":"str"},{"label":"G","value":"G","type":"str"},{"label":"H","value":"H","type":"str"},{"label":"I","value":"I","type":"str"},{"label":"J","value":"J","type":"str"},{"label":"K","value":"K","type":"str"},{"label":"L","value":"L","type":"str"},{"label":"M","value":"M","type":"str"},{"label":"N","value":"N","type":"str"},{"label":"Entrance","value":"Entrance","type":"str"},{"label":"OutSide","value":"OutSide","type":"str"}],"payload":"","topic":"","x":79,"y":2707,"wires":[["4035179a.073438"]]},{"id":"1a657134.af870f","type":"switch","z":"bca64c3b.0e4c","name":"Rooms","property":"Lroom","propertyType":"global","rules":[{"t":"eq","v":"A","vt":"str"},{"t":"eq","v":"B","vt":"str"},{"t":"eq","v":"C","vt":"str"},{"t":"eq","v":"D","vt":"str"},{"t":"eq","v":"E","vt":"str"},{"t":"eq","v":"F","vt":"str"},{"t":"eq","v":"G","vt":"str"},{"t":"eq","v":"H","vt":"str"},{"t":"eq","v":"I","vt":"str"},{"t":"eq","v":"J","vt":"str"},{"t":"eq","v":"K","vt":"str"},{"t":"eq","v":"L","vt":"str"},{"t":"eq","v":"M","vt":"str"},{"t":"eq","v":"N","vt":"str"},{"t":"eq","v":"Entrance","vt":"str"},{"t":"eq","v":"OutSide","vt":"str"}],"checkall":"true","repair":false,"outputs":16,"x":589,"y":2707,"wires":[["784cef3e.5b2e"],["3999ee3.765a612"],["2bd71789.e0fdc8"],["a82e76c2.473bf8"],["59b9a149.32db7"],["c9508676.c6d838"],["d4f3c555.e49308"],["e5eaf30.a17a31"],["96a3e2e2.38b2f"],["292adbea.1693a4"],["ca83135f.13072"],["386f9135.e3be2e"],["ca386b35.edf818"],["647a236c.f474fc"],["8164a9ff.6f9d88"],["28924bbb.c1d234","8bdfb0fe.d75cf","33e2a87c.0ad468","b4f5e328.45dc2"]]},{"id":"784cef3e.5b2e","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/A/Output/bool/Lights","qos":"","retain":"","broker":"a2c91eda.08e26","x":949,"y":2487,"wires":[]},{"id":"2bd71789.e0fdc8","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/C/Output/bool/Lights","qos":"","retain":"","broker":"a2c91eda.08e26","x":949,"y":2567,"wires":[]},{"id":"59b9a149.32db7","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/E/Output/bool/Lights","qos":"","retain":"","broker":"a2c91eda.08e26","x":949,"y":2647,"wires":[]},{"id":"d4f3c555.e49308","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/G/Output/bool/Lights","qos":"","retain":"","broker":"a2c91eda.08e26","x":949,"y":2727,"wires":[]},{"id":"e5eaf30.a17a31","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/H/Output/bool/Lights","qos":"","retain":"","broker":"a2c91eda.08e26","x":949,"y":2767,"wires":[]},{"id":"292adbea.1693a4","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/J/Output/bool/Lights","qos":"","retain":"","broker":"a2c91eda.08e26","x":949,"y":2847,"wires":[]},{"id":"ca83135f.13072","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/K/Output/bool/Lights","qos":"","retain":"","broker":"a2c91eda.08e26","x":949,"y":2887,"wires":[]},{"id":"386f9135.e3be2e","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/L/Output/bool/Lights","qos":"","retain":"","broker":"a2c91eda.08e26","x":949,"y":2927,"wires":[]},{"id":"ca386b35.edf818","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/M/Output/bool/Lights","qos":"","retain":"","broker":"a2c91eda.08e26","x":949,"y":2967,"wires":[]},{"id":"8164a9ff.6f9d88","type":"mqtt out","z":"bca64c3b.0e4c","name":"Lights_Entrance","topic":"/home/O/Output/bool/Lights_Entrance","qos":"","retain":"","broker":"a2c91eda.08e26","x":919,"y":3087,"wires":[]},{"id":"3999ee3.765a612","type":"function","z":"bca64c3b.0e4c","name":"Room B-2 Lights 1&2","func":"\nreturn msg;","outputs":1,"noerr":0,"x":929,"y":2527,"wires":[["89b86611.367558","9614041d.65c5b8"]]},{"id":"89b86611.367558","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/B/Output/bool/Lights_1","qos":"","retain":"","broker":"a2c91eda.08e26","x":1250,"y":2507,"wires":[]},{"id":"9614041d.65c5b8","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/B/Output/bool/Lights_2","qos":"","retain":"","broker":"a2c91eda.08e26","x":1250,"y":2547,"wires":[]},{"id":"a82e76c2.473bf8","type":"function","z":"bca64c3b.0e4c","name":"Room D-2 Lights 1&2","func":"\nreturn msg;","outputs":1,"noerr":0,"x":929,"y":2607,"wires":[["244bf3bc.9d854c","25790ccf.fd5284"]]},{"id":"c9508676.c6d838","type":"function","z":"bca64c3b.0e4c","name":"Room F-2 Lights 1&2","func":"\nreturn msg;","outputs":1,"noerr":0,"x":929,"y":2687,"wires":[["c5d1d6f3.377538","64a405b7.17279c"]]},{"id":"96a3e2e2.38b2f","type":"function","z":"bca64c3b.0e4c","name":"Room I-2 Lights 1&2","func":"\nreturn msg;","outputs":1,"noerr":0,"x":929,"y":2807,"wires":[["3541cc1.6368034","d452ace7.ba4a"]]},{"id":"647a236c.f474fc","type":"function","z":"bca64c3b.0e4c","name":"Room N-2 Lights 1&2&3","func":"\nreturn msg;","outputs":1,"noerr":0,"x":939,"y":3027,"wires":[["f3e67ebe.6eee","e2f1027b.abd7c","b215b875.fd75a8"]]},{"id":"25790ccf.fd5284","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/D/Output/bool/Lights_2","qos":"","retain":"","broker":"a2c91eda.08e26","x":1250,"y":2627,"wires":[]},{"id":"244bf3bc.9d854c","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/D/Output/bool/Lights_1","qos":"","retain":"","broker":"a2c91eda.08e26","x":1250,"y":2587,"wires":[]},{"id":"64a405b7.17279c","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/F/Output/bool/Lights_2","qos":"","retain":"","broker":"a2c91eda.08e26","x":1250,"y":2707,"wires":[]},{"id":"c5d1d6f3.377538","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/F/Output/bool/Lights_1","qos":"","retain":"","broker":"a2c91eda.08e26","x":1250,"y":2667,"wires":[]},{"id":"3541cc1.6368034","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/I/Output/bool/Lights_1","qos":"","retain":"","broker":"a2c91eda.08e26","x":1250,"y":2774,"wires":[]},{"id":"d452ace7.ba4a","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/I/Output/bool/Lights_2","qos":"","retain":"","broker":"a2c91eda.08e26","x":1250,"y":2834,"wires":[]},{"id":"f3e67ebe.6eee","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/N/Output/bool/Lights_1","qos":"","retain":"","broker":"a2c91eda.08e26","x":1250,"y":2987,"wires":[]},{"id":"e2f1027b.abd7c","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/N/Output/bool/Lights_2","qos":"","retain":"","broker":"a2c91eda.08e26","x":1250,"y":3027,"wires":[]},{"id":"b215b875.fd75a8","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/N/Output/bool/Lights_3","qos":"","retain":"","broker":"a2c91eda.08e26","x":1250,"y":3067,"wires":[]},{"id":"4035179a.073438","type":"function","z":"bca64c3b.0e4c","name":"set room","func":"if(context.global.Lroom === undefined){\n    context.global.set(\"Lroom\");\n}\ncontext.global.Lroom = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"x":209,"y":2707,"wires":[["28d83641.a198da","4b0931a6.60efc"]]},{"id":"4b0931a6.60efc","type":"ui_button","z":"bca64c3b.0e4c","name":"","group":"55c8875e.fd1cd8","order":0,"width":"1","height":"1","passthru":false,"label":"ON","color":"","bgcolor":"","icon":"","payload":"true","payloadType":"bool","topic":"","x":399,"y":2767,"wires":[["1a657134.af870f"]]},{"id":"28d83641.a198da","type":"ui_button","z":"bca64c3b.0e4c","name":"","group":"55c8875e.fd1cd8","order":0,"width":"1","height":"1","passthru":false,"label":"OFF","color":"","bgcolor":"","icon":"","payload":"false","payloadType":"bool","topic":"","x":399,"y":2647,"wires":[["1a657134.af870f"]]},{"id":"f906698.bc63498","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/D/Output/bool/Roller_Shades_(Up)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1619,"y":1407,"wires":[]},{"id":"59761d80.70add4","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/D/Output/bool/Roller_Shades_(Down)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1629,"y":1947,"wires":[]},{"id":"e75e8aa1.bdfb98","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/E/Output/bool/Roller_Shades_(Up)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1619,"y":1447,"wires":[]},{"id":"edf8af01.ac7fc","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/E/Output/bool/Roller_Shades_(Down)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1629,"y":1987,"wires":[]},{"id":"15e8cc7c.6b5344","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/F/Output/bool/Roller_Shades_(Up)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1619,"y":1487,"wires":[]},{"id":"eca1f25c.3b4d4","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/F/Output/bool/Roller_Shades_(Down)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1629,"y":2027,"wires":[]},{"id":"a5650383.634c6","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/G/Output/bool/Roller_Shades_(Up)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1619,"y":1527,"wires":[]},{"id":"507e3c44.c872a4","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/G/Output/bool/Roller_Shades_(Down)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1629,"y":2067,"wires":[]},{"id":"c2e9fe96.991b5","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/H/Output/bool/Roller_Shades_(Up)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1619,"y":1567,"wires":[]},{"id":"187c102f.073f1","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/H/Output/bool/Roller_Shades_(Down)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1629,"y":2107,"wires":[]},{"id":"a916fb6e.0ac3e8","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/J/Output/bool/Roller_Shades_(Up)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1619,"y":1607,"wires":[]},{"id":"7eb4bc13.f20294","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/J/Output/bool/Roller_Shades_(Down)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1619,"y":2147,"wires":[]},{"id":"9a67c72.534ce38","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/L/Output/bool/Roller_Shades_(Up)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1619,"y":1647,"wires":[]},{"id":"7694c44.146f53c","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/L/Output/bool/Roller_Shades_(Down)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1619,"y":2187,"wires":[]},{"id":"2db6bca2.59a074","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/M/Output/bool/Roller_Shades_(Up)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1619,"y":1687,"wires":[]},{"id":"6775ea7d.3c94c4","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/N/Output/bool/Roller_Shades_(Up)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1619,"y":1727,"wires":[]},{"id":"8ac6a6a4.0b2d28","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/M/Output/bool/Roller_Shades_(Down)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1629,"y":2227,"wires":[]},{"id":"94e09e23.08506","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/N/Output/bool/Roller_Shades_(Down)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1629,"y":2267,"wires":[]},{"id":"27ff3ef2.18ea42","type":"ui_dropdown","z":"bca64c3b.0e4c","name":"Room","label":"","place":"","group":"1a479358.3ef61d","order":0,"width":"3","height":"1","passthru":true,"options":[{"label":"A","value":"A","type":"str"},{"label":"B","value":"B","type":"str"},{"label":"C","value":"C","type":"str"},{"label":"D","value":"D","type":"str"},{"label":"E","value":"E","type":"str"},{"label":"F","value":"F","type":"str"},{"label":"G","value":"G","type":"str"},{"label":"H","value":"H","type":"str"},{"label":"I","value":"I","type":"str"},{"label":"J","value":"J","type":"str"},{"label":"K","value":"K","type":"str"},{"label":"L","value":"L","type":"str"},{"label":"M","value":"M","type":"str"},{"label":"N","value":"N","type":"str"},{"label":"OutSide","value":"O","type":"str"}],"payload":"","topic":"","x":79,"y":3867,"wires":[["ff7d52fd.b3eed"]]},{"id":"ff7d52fd.b3eed","type":"function","z":"bca64c3b.0e4c","name":"set Vroom","func":"if(context.global.Vroom === undefined){\n    context.global.set(\"Vroom\");\n}\ncontext.global.Vroom = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"x":229,"y":3867,"wires":[["9082df01.26ddc","f97a08f.79b13f8"]]},{"id":"f97a08f.79b13f8","type":"ui_button","z":"bca64c3b.0e4c","name":"","group":"1a479358.3ef61d","order":0,"width":"1","height":"1","passthru":false,"label":"UP","color":"","bgcolor":"","icon":"","payload":"true","payloadType":"bool","topic":"","x":419,"y":3907,"wires":[["7306beeb.58d15"]]},{"id":"9082df01.26ddc","type":"ui_button","z":"bca64c3b.0e4c","name":"","group":"1a479358.3ef61d","order":0,"width":"1","height":"1","passthru":false,"label":"DOWN","color":"","bgcolor":"","icon":"","payload":"false","payloadType":"bool","topic":"","x":429,"y":3827,"wires":[["7306beeb.58d15"]]},{"id":"3e0fdbb8.8665f4","type":"comment","z":"bca64c3b.0e4c","name":"Remote volet","info":"","x":59,"y":3727,"wires":[]},{"id":"b6f4b84f.ca54d8","type":"function","z":"bca64c3b.0e4c","name":"Open","func":"msg.payload = true;\nreturn msg;","outputs":1,"noerr":0,"x":809,"y":3927,"wires":[["3d257908.ff7776","d91e2d78.b2538"]]},{"id":"178d7d99.23f572","type":"function","z":"bca64c3b.0e4c","name":"Close","func":"\nreturn msg;","outputs":1,"noerr":0,"x":809,"y":3807,"wires":[["adb8749.3345488","e5e76b3.978c598"]]},{"id":"d91e2d78.b2538","type":"change","z":"bca64c3b.0e4c","name":"reverse","rules":[{"t":"set","p":"payload","pt":"msg","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":959,"y":3947,"wires":[["1618476c.c15619"]]},{"id":"3d257908.ff7776","type":"trigger","z":"bca64c3b.0e4c","op1":"true","op2":"false","op1type":"bool","op2type":"bool","duration":"1","extend":false,"units":"s","reset":"","bytopic":"topic","name":"ActionTime","x":979,"y":3907,"wires":[["c2ea8d91.92111"]]},{"id":"e5e76b3.978c598","type":"change","z":"bca64c3b.0e4c","name":"reverse","rules":[{"t":"set","p":"payload","pt":"msg","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":959,"y":3787,"wires":[["c2ea8d91.92111"]]},{"id":"adb8749.3345488","type":"trigger","z":"bca64c3b.0e4c","op1":"true","op2":"false","op1type":"bool","op2type":"bool","duration":"1","extend":false,"units":"s","reset":"","bytopic":"topic","name":"ActionTime","x":979,"y":3827,"wires":[["1618476c.c15619"]]},{"id":"7306beeb.58d15","type":"switch","z":"bca64c3b.0e4c","name":"choseMode","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"false","vt":"jsonata"},{"t":"eq","v":"true","vt":"jsonata"}],"checkall":"true","repair":false,"outputs":2,"x":629,"y":3867,"wires":[["178d7d99.23f572"],["b6f4b84f.ca54d8"]]},{"id":"c2ea8d91.92111","type":"function","z":"bca64c3b.0e4c","name":"UP","func":"\nreturn msg;","outputs":1,"noerr":0,"x":1199,"y":3787,"wires":[["cc2647ad.0cccf8"]]},{"id":"1618476c.c15619","type":"function","z":"bca64c3b.0e4c","name":"DOWN","func":"\nreturn msg;","outputs":1,"noerr":0,"x":1209,"y":3947,"wires":[["31ce0c5d.34c524"]]},{"id":"28924bbb.c1d234","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/O/Output/float/Lights_Pool_(Analog)","qos":"","retain":"","broker":"a2c91eda.08e26","x":999,"y":3147,"wires":[]},{"id":"33e2a87c.0ad468","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/O/Output/float/Lights_Porch_1_(Analog)","qos":"","retain":"","broker":"a2c91eda.08e26","x":1009,"y":3227,"wires":[]},{"id":"8bdfb0fe.d75cf","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/O/Output/float/Lights_Porch_2_(Analog)","qos":"","retain":"","broker":"a2c91eda.08e26","x":1009,"y":3187,"wires":[]},{"id":"b4f5e328.45dc2","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/O/Output/float/Lights_Garden_(Analog)","qos":"","retain":"","broker":"a2c91eda.08e26","x":1009,"y":3267,"wires":[]},{"id":"cc2647ad.0cccf8","type":"switch","z":"bca64c3b.0e4c","name":"Room","property":"Vroom","propertyType":"global","rules":[{"t":"eq","v":"A","vt":"str"},{"t":"eq","v":"D","vt":"str"},{"t":"eq","v":"E","vt":"str"},{"t":"eq","v":"F","vt":"str"},{"t":"eq","v":"G","vt":"str"},{"t":"eq","v":"H","vt":"str"},{"t":"eq","v":"J","vt":"str"},{"t":"eq","v":"L","vt":"str"},{"t":"eq","v":"M","vt":"str"},{"t":"eq","v":"N","vt":"str"}],"checkall":"true","repair":false,"outputs":10,"x":1409,"y":3627,"wires":[["ee8c653a.2cdc38","8e91ec5c.f5f45","412a46f5.2ed648","a135916d.b8426"],["11f04381.dc7a0c"],["653d8021.c4763"],["e2034c98.b4b94"],["77c27fed.f94c4"],["57347c56.e18c94"],["a4fc3cd0.3e972"],["9f60c498.4307b8"],["a5dc909d.45afb"],["251fc23f.253afe"]]},{"id":"ee8c653a.2cdc38","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/A/Output/bool/Roller_Shades_1_(Up)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1779,"y":3387,"wires":[]},{"id":"8e91ec5c.f5f45","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/A/Output/bool/Roller_Shades_2_(Up)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1779,"y":3427,"wires":[]},{"id":"412a46f5.2ed648","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/A/Output/bool/Roller_Shades_3_(Up)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1779,"y":3467,"wires":[]},{"id":"a135916d.b8426","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/A/Output/bool/Roller_Shades_4_(Up)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1779,"y":3507,"wires":[]},{"id":"11f04381.dc7a0c","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/D/Output/bool/Roller_Shades_(Up)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1779,"y":3547,"wires":[]},{"id":"653d8021.c4763","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/E/Output/bool/Roller_Shades_(Up)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1779,"y":3587,"wires":[]},{"id":"e2034c98.b4b94","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/F/Output/bool/Roller_Shades_(Up)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1779,"y":3627,"wires":[]},{"id":"77c27fed.f94c4","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/G/Output/bool/Roller_Shades_(Up)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1779,"y":3667,"wires":[]},{"id":"57347c56.e18c94","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/H/Output/bool/Roller_Shades_(Up)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1779,"y":3707,"wires":[]},{"id":"a4fc3cd0.3e972","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/J/Output/bool/Roller_Shades_(Up)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1779,"y":3747,"wires":[]},{"id":"9f60c498.4307b8","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/L/Output/bool/Roller_Shades_(Up)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1779,"y":3787,"wires":[]},{"id":"a5dc909d.45afb","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/M/Output/bool/Roller_Shades_(Up)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1779,"y":3827,"wires":[]},{"id":"251fc23f.253afe","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/N/Output/bool/Roller_Shades_(Up)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1779,"y":3867,"wires":[]},{"id":"62a5cf77.c0b9e","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/A/Output/bool/Roller_Shades_1_(Down)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1789,"y":3907,"wires":[]},{"id":"b87f44dd.98f938","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/A/Output/bool/Roller_Shades_2_(Down)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1789,"y":3947,"wires":[]},{"id":"c8ed3b1d.606138","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/A/Output/bool/Roller_Shades_3_(Down)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1789,"y":3987,"wires":[]},{"id":"15e1b811.875668","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/A/Output/bool/Roller_Shades_4_(Down)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1789,"y":4027,"wires":[]},{"id":"fec51ca2.fb1a9","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/D/Output/bool/Roller_Shades_(Down)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1789,"y":4087,"wires":[]},{"id":"7f0fd0cf.2bcce","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/E/Output/bool/Roller_Shades_(Down)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1789,"y":4127,"wires":[]},{"id":"5aa49041.e3592","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/F/Output/bool/Roller_Shades_(Down)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1789,"y":4167,"wires":[]},{"id":"72094357.9010ec","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/G/Output/bool/Roller_Shades_(Down)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1789,"y":4207,"wires":[]},{"id":"619477a6.5f6158","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/H/Output/bool/Roller_Shades_(Down)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1829,"y":4247,"wires":[]},{"id":"d0fb14d0.48dde8","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/J/Output/bool/Roller_Shades_(Down)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1779,"y":4287,"wires":[]},{"id":"ca188f3a.87afb","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/L/Output/bool/Roller_Shades_(Down)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1779,"y":4327,"wires":[]},{"id":"3bb6c16.08a363e","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/M/Output/bool/Roller_Shades_(Down)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1789,"y":4367,"wires":[]},{"id":"1072885.736bf78","type":"mqtt out","z":"bca64c3b.0e4c","name":"","topic":"/home/N/Output/bool/Roller_Shades_(Down)","qos":"","retain":"","broker":"e6cc5916.4480c8","x":1789,"y":4407,"wires":[]},{"id":"31ce0c5d.34c524","type":"switch","z":"bca64c3b.0e4c","name":"Room","property":"Vroom","propertyType":"global","rules":[{"t":"eq","v":"A","vt":"str"},{"t":"eq","v":"D","vt":"str"},{"t":"eq","v":"E","vt":"str"},{"t":"eq","v":"F","vt":"str"},{"t":"eq","v":"G","vt":"str"},{"t":"eq","v":"H","vt":"str"},{"t":"eq","v":"J","vt":"str"},{"t":"eq","v":"L","vt":"str"},{"t":"eq","v":"M","vt":"str"},{"t":"eq","v":"N","vt":"str"}],"checkall":"true","repair":false,"outputs":10,"x":1409,"y":4107,"wires":[["62a5cf77.c0b9e","b87f44dd.98f938","c8ed3b1d.606138","15e1b811.875668"],["fec51ca2.fb1a9"],["7f0fd0cf.2bcce"],["5aa49041.e3592"],["72094357.9010ec"],["619477a6.5f6158"],["d0fb14d0.48dde8"],["ca188f3a.87afb"],["3bb6c16.08a363e"],["1072885.736bf78"]]},{"id":"cc3460b7.e917d","type":"comment","z":"bca64c3b.0e4c","name":"Remote Auto-Manu-Switch","info":"","x":110,"y":4120,"wires":[]},{"id":"62e806a6.25d018","type":"ui_switch","z":"bca64c3b.0e4c","name":"Manu-mode","label":"Manu mode","group":"e451255c.558d48","order":0,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":200,"y":4180,"wires":[["bbe453d0.cb4d7"]]},{"id":"bbe453d0.cb4d7","type":"function","z":"bca64c3b.0e4c","name":"SetMode","func":"if(context.global.Manu === undefined){\n    context.global.set(\"Manu\");\n}\ncontext.global.Manu = msg.payload;\n\n","outputs":0,"noerr":0,"x":410,"y":4180,"wires":[]},{"id":"65806d8b.cb1944","type":"function","z":"bca64c3b.0e4c","name":"ifAutoMode?","func":"if(!global.get(\"Manu\")){\n    return msg;\n}","outputs":1,"noerr":0,"x":959,"y":1087,"wires":[["d6243fa5.96dd3"]]},{"id":"b2e393bd.34667","type":"function","z":"bca64c3b.0e4c","name":"ifAutoMode?","func":"if(!global.get(\"Manu\")){\n    return msg;\n}","outputs":1,"noerr":0,"x":210,"y":4260,"wires":[[]]},{"id":"9ad9201a.15832","type":"function","z":"bca64c3b.0e4c","name":"ifAutoMode?","func":"if(!global.get(\"Manu\")){\n    return msg;\n}","outputs":1,"noerr":0,"x":219,"y":1767,"wires":[["62b1684a.479258"]]},{"id":"b2f0dc7c.37ec","type":"function","z":"bca64c3b.0e4c","name":"ifAutoMode?","func":"if(!global.get(\"Manu\")){\n    return msg;\n}","outputs":1,"noerr":0,"x":279,"y":467,"wires":[["e736fa87.8959e8"]]},{"id":"39365973.63b366","type":"mqtt in","z":"bca64c3b.0e4c","name":"","topic":"/home/+/Input/bool/Motion_Detector","qos":"2","broker":"a2c91eda.08e26","x":180,"y":4560,"wires":[["e4570519.4b0a08"]]},{"id":"6f1a7d98.a3c614","type":"function","z":"bca64c3b.0e4c","name":"","func":"var msgA = {};\nmsgA.topic = 'A';\nmsgA.payload = 0;\n\nmsgB = {};\nmsgB.topic = 'B';\nmsgB.payload = 0;\n\nmsgD = {};\nmsgD.topic = 'D';\nmsgD.payload = 0;\n\nmsgE1 = {};\nmsgE1.topic = 'E';\nmsgE1.payload = 0;\n\n\nmsgE2 = {};\nmsgE2.topic = 'E';\nmsgE2.payload = 0;\n\n\nmsgF = {};\nmsgF.topic = 'F';\nmsgF.payload = 0;\n\n\nmsgG = {};\nmsgG.topic = 'G';\nmsgG.payload = 0;\n\nmsgH = {};\nmsgH.topic = 'H';\nmsgH.payload = 0;\n\nmsgI = {};\nmsgI.topic = 'I';\nmsgI.payload = 0;\n\nmsgJ = {};\nmsgJ.topic = 'J';\nmsgJ.payload = 0;\n\nmsgK = {};\nmsgK.topic = 'K';\nmsgK.payload = 0;\n\nmsgL = {};\nmsgL.topic = 'L';\nmsgL.payload = 0;\n\nmsgM = {};\nmsgM.topic = 'M';\nmsgM.payload = 0;\n\nmsgN = {};\nmsgN.topic = 'N';\nmsgN.payload = 0;\nvar arr = [msgA,msgB,msgD,msgE1,msgE2,msgF,msgG,msgH,msgI,msgJ,msgK,msgL,msgM,msgN];\n\n\nvar split = msg.topic.split(/[/]+/);\n\nmsg.room = split[2];\narr.forEach(function(name){\n    if(name.topic == msg.room){\n        if(msg.payload){\n            name.payload = 1;\n        }else{\n            name.payload = 0;\n        }\n    }\n})\n\nreturn arr;\n","outputs":14,"noerr":0,"x":570,"y":4560,"wires":[["561c985b.eac2f8"],["561c985b.eac2f8"],["561c985b.eac2f8"],["561c985b.eac2f8"],["561c985b.eac2f8"],["561c985b.eac2f8"],["561c985b.eac2f8"],["561c985b.eac2f8"],["561c985b.eac2f8"],["561c985b.eac2f8"],["561c985b.eac2f8"],["561c985b.eac2f8"],["561c985b.eac2f8"],["561c985b.eac2f8"]]},{"id":"561c985b.eac2f8","type":"ui_chart","z":"bca64c3b.0e4c","name":"","group":"3d4cb1fb.37d88e","order":0,"width":"3","height":"15","label":"chart","chartType":"horizontalBar","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"0","ymax":"1","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":true,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"x":770,"y":4560,"wires":[[],[]]},{"id":"5ae89ca1.5c2264","type":"switch","z":"bca64c3b.0e4c","name":"seperate signal","property":"open","propertyType":"msg","rules":[{"t":"eq","v":"true","vt":"jsonata"},{"t":"eq","v":"false","vt":"jsonata"}],"checkall":"true","repair":false,"outputs":2,"x":260,"y":4700,"wires":[["6f1a7d98.a3c614"],[]]},{"id":"e4570519.4b0a08","type":"function","z":"bca64c3b.0e4c","name":"setmode","func":"a = \"True\";\nif(msg.payload == a){\n    msg.open = true;\n}else{\n    msg.open = false;\n}\n\nreturn msg;\n","outputs":1,"noerr":0,"x":270,"y":4620,"wires":[["5ae89ca1.5c2264"]]},{"id":"66e6ce19.241c6","type":"mqtt-broker","z":"","broker":"localhost","port":"1883","clientid":"","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"7153c242.194b6c","type":"mqtt-broker","z":"","broker":"sparks-vm24.i3s.unice.fr","port":"1883","clientid":"","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"a2c91eda.08e26","type":"mqtt-broker","z":"","name":"","broker":"127.0.0.1","port":"1883","clientid":"","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"e6cc5916.4480c8","type":"mqtt-broker","z":"","name":"","broker":"127.0.0.1","port":"1883","clientid":"","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"55c8875e.fd1cd8","type":"ui_group","z":"","name":"Lumiere","tab":"dd5cfe14.33fc6","disp":true,"width":"6","collapse":false},{"id":"1a479358.3ef61d","type":"ui_group","z":"","name":"Volet","tab":"dd5cfe14.33fc6","disp":true,"width":"6","collapse":false},{"id":"e451255c.558d48","type":"ui_group","z":"","name":"Mode Switch","tab":"dd5cfe14.33fc6","disp":true,"width":"6","collapse":false},{"id":"3d4cb1fb.37d88e","type":"ui_group","z":"","name":"Room etat","tab":"dd5cfe14.33fc6","disp":true,"width":"6","collapse":false},{"id":"dd5cfe14.33fc6","type":"ui_tab","z":"","name":"Home","icon":"dashboard"}]